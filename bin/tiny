#!/usr/bin/env node

var program = require('commander')
var PKG = require('../package.json')

patch(program)

program
  .version(PKG.version)
  .usage('[cmd] [options]')
  .allowUnknownOption()

program
  .command('compress', 'default task', {
    isDefault: true
  })
  .command('apikey', 'manage apikeys of https://tinypng.com')

program
  .parse(process.argv)

if (!process.argv.slice(2).length) {
  program.outputHelp()
}

function patch(instance) {
  // patch executeSubCommand for orderly argvs
  var monkey = instance.executeSubCommand
  instance.executeSubCommand = function (argv) {
    return monkey.call(instance, argv, argv.slice(2), [])
  }
}
